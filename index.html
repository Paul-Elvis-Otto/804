<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Structural Comparison of North Carolina and Peer States</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="index_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="index_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap-d6a003b94517c951b2d65075d42fb01b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="index_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="index_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#structural-comparison-of-north-carolina-and-peer-states" id="toc-structural-comparison-of-north-carolina-and-peer-states" class="nav-link active" data-scroll-target="#structural-comparison-of-north-carolina-and-peer-states">Structural Comparison of North Carolina and Peer States</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">1. Introduction</a></li>
  <li><a href="#data-and-variable-construction" id="toc-data-and-variable-construction" class="nav-link" data-scroll-target="#data-and-variable-construction">2. Data and Variable Construction</a>
  <ul class="collapse">
  <li><a href="#economic-structure" id="toc-economic-structure" class="nav-link" data-scroll-target="#economic-structure">2.1 Economic Structure</a></li>
  <li><a href="#educational-composition-population-25" id="toc-educational-composition-population-25" class="nav-link" data-scroll-target="#educational-composition-population-25">2.2 Educational Composition (Population 25+)</a></li>
  <li><a href="#labor-market-structure" id="toc-labor-market-structure" class="nav-link" data-scroll-target="#labor-market-structure">2.3 Labor Market Structure</a></li>
  <li><a href="#demographic-structure" id="toc-demographic-structure" class="nav-link" data-scroll-target="#demographic-structure">2.4 Demographic Structure</a></li>
  <li><a href="#acs-variable-mapping" id="toc-acs-variable-mapping" class="nav-link" data-scroll-target="#acs-variable-mapping">2.5 ACS Variable Mapping</a></li>
  <li><a href="#exploratory-visualization-income" id="toc-exploratory-visualization-income" class="nav-link" data-scroll-target="#exploratory-visualization-income">2.6 Exploratory Visualization (Income)</a></li>
  </ul></li>
  <li><a href="#conceptual-framework" id="toc-conceptual-framework" class="nav-link" data-scroll-target="#conceptual-framework">3. Conceptual Framework</a></li>
  <li><a href="#standardization" id="toc-standardization" class="nav-link" data-scroll-target="#standardization">4. Standardization</a></li>
  <li><a href="#distance-based-similarity" id="toc-distance-based-similarity" class="nav-link" data-scroll-target="#distance-based-similarity">5. Distance-Based Similarity</a>
  <ul class="collapse">
  <li><a href="#implementation" id="toc-implementation" class="nav-link" data-scroll-target="#implementation">5.1 Implementation</a></li>
  </ul></li>
  <li><a href="#temporal-consistency" id="toc-temporal-consistency" class="nav-link" data-scroll-target="#temporal-consistency">6. Temporal Consistency</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">7. Interpretation</a></li>
  <li><a href="#methodological-considerations" id="toc-methodological-considerations" class="nav-link" data-scroll-target="#methodological-considerations">8. Methodological Considerations</a>
  <ul class="collapse">
  <li><a href="#equal-weighting" id="toc-equal-weighting" class="nav-link" data-scroll-target="#equal-weighting">8.1 Equal Weighting</a></li>
  <li><a href="#covariance-structure" id="toc-covariance-structure" class="nav-link" data-scroll-target="#covariance-structure">8.2 Covariance Structure</a></li>
  <li><a href="#cross-sectional-standardization" id="toc-cross-sectional-standardization" class="nav-link" data-scroll-target="#cross-sectional-standardization">8.3 Cross-Sectional Standardization</a></li>
  <li><a href="#causal-interpretation" id="toc-causal-interpretation" class="nav-link" data-scroll-target="#causal-interpretation">8.4 Causal Interpretation</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">9. Conclusion</a></li>
  <li><a href="#appendix-north-carolina-workforce-context" id="toc-appendix-north-carolina-workforce-context" class="nav-link" data-scroll-target="#appendix-north-carolina-workforce-context">Appendix: North Carolina Workforce Context</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Structural Comparison of North Carolina and Peer States</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="structural-comparison-of-north-carolina-and-peer-states" class="level1">
<h1>Structural Comparison of North Carolina and Peer States</h1>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">1. Introduction</h2>
<p>This chapter identifies U.S. states that exhibit structural similarity to North Carolina (NC) along key dimensions of economic development and labor market composition. The purpose is to define a defensible comparison set for subsequent analysis of labor market development. Rather than selecting comparator states ad hoc, the approach formalizes similarity using a multivariate distance metric applied to harmonized state-level indicators.</p>
<p>The analysis is exploratory and descriptive in nature. It does not aim to establish causal relationships but to construct a transparent and replicable framework for identifying observationally comparable states based on structural characteristics.</p>
</section>
<section id="data-and-variable-construction" class="level2">
<h2 class="anchored" data-anchor-id="data-and-variable-construction">2. Data and Variable Construction</h2>
<p>State-level data are drawn from the American Community Survey (ACS) 1-year estimates for the period 2015-2025. The ACS provides harmonized, nationally comparable data on income, education, labor force status, and demographic composition.</p>
<p>Indicators are grouped into four conceptual domains.</p>
<section id="economic-structure" class="level3">
<h3 class="anchored" data-anchor-id="economic-structure">2.1 Economic Structure</h3>
<ul>
<li>Median household income</li>
<li>Poverty rate</li>
<li>Gini coefficient of income inequality</li>
</ul>
<p>The poverty rate is constructed as:</p>
<p><span class="math display">\[
\text{Poverty Rate}_{it} =
\frac{\text{Population Below Poverty}_{it}}{\text{Total Population for Poverty Determination}_{it}}
\]</span></p>
</section>
<section id="educational-composition-population-25" class="level3">
<h3 class="anchored" data-anchor-id="educational-composition-population-25">2.2 Educational Composition (Population 25+)</h3>
<ul>
<li>Share of population aged 25+ with a Bachelor’s degree or higher</li>
</ul>
<p><span class="math display">\[
\text{BA+ Share}_{it} =
\frac{\text{BA}_{it} + \text{MA}_{it} + \text{Professional}_{it} + \text{PhD}_{it}}{\text{Population 25+}_{it}}
\]</span></p>
</section>
<section id="labor-market-structure" class="level3">
<h3 class="anchored" data-anchor-id="labor-market-structure">2.3 Labor Market Structure</h3>
<ul>
<li>Unemployment rate</li>
<li>Labor force participation rate (LFPR)</li>
<li>Employment-to-population ratio</li>
</ul>
<p><span class="math display">\[
\text{Unemployment Rate}_{it} =
\frac{\text{Unemployed}_{it}}{\text{Labor Force}_{it}}
\]</span></p>
<p><span class="math display">\[
\text{LFPR}_{it} =
\frac{\text{Labor Force}_{it}}{\text{Population 16+}_{it}}
\]</span></p>
<p><span class="math display">\[
\text{Employment-Population Ratio}_{it} =
\frac{\text{Employed}_{it}}{\text{Population 16+}_{it}}
\]</span></p>
</section>
<section id="demographic-structure" class="level3">
<h3 class="anchored" data-anchor-id="demographic-structure">2.4 Demographic Structure</h3>
<ul>
<li>Median age</li>
<li>Share Black</li>
<li>Share Hispanic</li>
<li>Share foreign-born</li>
<li>Total population</li>
</ul>
<p>Shares are constructed relative to their appropriate denominators (e.g., race total, Hispanic origin total, place-of-birth total).</p>
<p>All variables are treated as state-level structural characteristics observed annually.</p>
</section>
<section id="acs-variable-mapping" class="level3">
<h3 class="anchored" data-anchor-id="acs-variable-mapping">2.5 ACS Variable Mapping</h3>
<div id="tbl-acs-variable-mapping" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-acs-variable-mapping-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: ACS variable mapping used to construct structural indicators.
</figcaption>
<div aria-describedby="tbl-acs-variable-mapping-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="table-responsive">
<table class="table table-striped table-hover table-condensed cell caption-top table-sm small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Category</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable Code</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Economics</td>
<td style="text-align: left;">B19013_001</td>
<td style="text-align: left;">Median household income in the past 12 months</td>
</tr>
<tr class="even">
<td style="text-align: left;">Economics</td>
<td style="text-align: left;">B17001_001</td>
<td style="text-align: left;">Poverty status in the past 12 months (total)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Economics</td>
<td style="text-align: left;">B17001_002</td>
<td style="text-align: left;">Income in the past 12 months below poverty</td>
</tr>
<tr class="even">
<td style="text-align: left;">Economics</td>
<td style="text-align: left;">B19083_001</td>
<td style="text-align: left;">Gini index of income inequality</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Education (25+)</td>
<td style="text-align: left;">B15003_001</td>
<td style="text-align: left;">Total population 25+ years</td>
</tr>
<tr class="even">
<td style="text-align: left;">Education (25+)</td>
<td style="text-align: left;">B15003_021</td>
<td style="text-align: left;">Bachelor's degree</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Education (25+)</td>
<td style="text-align: left;">B15003_022</td>
<td style="text-align: left;">Master's degree</td>
</tr>
<tr class="even">
<td style="text-align: left;">Education (25+)</td>
<td style="text-align: left;">B15003_023</td>
<td style="text-align: left;">Professional school degree</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Education (25+)</td>
<td style="text-align: left;">B15003_025</td>
<td style="text-align: left;">Doctorate degree</td>
</tr>
<tr class="even">
<td style="text-align: left;">Labor Force</td>
<td style="text-align: left;">B23025_001</td>
<td style="text-align: left;">Population 16+ years</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Labor Force</td>
<td style="text-align: left;">B23025_003</td>
<td style="text-align: left;">Civilian labor force</td>
</tr>
<tr class="even">
<td style="text-align: left;">Labor Force</td>
<td style="text-align: left;">B23025_004</td>
<td style="text-align: left;">Employed</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Labor Force</td>
<td style="text-align: left;">B23025_005</td>
<td style="text-align: left;">Unemployed</td>
</tr>
<tr class="even">
<td style="text-align: left;">Demographics</td>
<td style="text-align: left;">B01002_001</td>
<td style="text-align: left;">Median age</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Demographics</td>
<td style="text-align: left;">B01003_001</td>
<td style="text-align: left;">Total population</td>
</tr>
<tr class="even">
<td style="text-align: left;">Demographics</td>
<td style="text-align: left;">B02001_001</td>
<td style="text-align: left;">Total race population</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Demographics</td>
<td style="text-align: left;">B02001_003</td>
<td style="text-align: left;">Black or African American alone</td>
</tr>
<tr class="even">
<td style="text-align: left;">Demographics</td>
<td style="text-align: left;">B03003_001</td>
<td style="text-align: left;">Total Hispanic origin population</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Demographics</td>
<td style="text-align: left;">B03003_003</td>
<td style="text-align: left;">Hispanic or Latino</td>
</tr>
<tr class="even">
<td style="text-align: left;">Demographics</td>
<td style="text-align: left;">B05002_001</td>
<td style="text-align: left;">Total place of birth population</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Demographics</td>
<td style="text-align: left;">B05002_013</td>
<td style="text-align: left;">Foreign born</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</section>
<section id="exploratory-visualization-income" class="level3">
<h3 class="anchored" data-anchor-id="exploratory-visualization-income">2.6 Exploratory Visualization (Income)</h3>
<p>Before constructing multivariate similarity, the figures below provide a simple example using median household income.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/plt-income-all-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The plot below shows the median income of the lower 48 with a diverging scale centered on North Carolina.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/plt-income-nc-anchor-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="conceptual-framework" class="level2">
<h2 class="anchored" data-anchor-id="conceptual-framework">3. Conceptual Framework</h2>
<p>Let:</p>
<ul>
<li><span class="math inline">\(i = 1, \dots, N\)</span> index states</li>
<li><span class="math inline">\(t = 2015, \dots, 2025\)</span> index years</li>
<li><span class="math inline">\(k = 1, \dots, K\)</span> index features</li>
</ul>
<p>Define the feature vector:</p>
<p><span class="math display">\[
\mathbf{x}_{it} = (x_{i1t}, \dots, x_{iKt})'
\]</span></p>
<p>where <span class="math inline">\(\mathbf{x}_{it} \in \mathbb{R}^K\)</span> contains the structural indicators for state <span class="math inline">\(i\)</span> in year <span class="math inline">\(t\)</span>.</p>
<p>For each year <span class="math inline">\(t\)</span>, we construct a cross-sectional feature matrix:</p>
<p><span class="math display">\[
X_t =
\begin{bmatrix}
\mathbf{x}_{1t}' \\
\mathbf{x}_{2t}' \\
\vdots \\
\mathbf{x}_{Nt}'
\end{bmatrix}
\]</span></p>
<p>The objective is to measure the proximity of each state <span class="math inline">\(i\)</span> to North Carolina in this multivariate feature space.</p>
</section>
<section id="standardization" class="level2">
<h2 class="anchored" data-anchor-id="standardization">4. Standardization</h2>
<p>Because features are measured in heterogeneous units (dollars, rates, shares, counts), direct comparison would lead to scale dominance by high-variance variables. Therefore, each feature is standardized cross-sectionally within year:</p>
<p><span class="math display">\[
z_{ikt} = \frac{x_{ikt} - \mu_{kt}}{\sigma_{kt}}
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(\mu_{kt}\)</span> is the mean of feature <span class="math inline">\(k\)</span> across states in year <span class="math inline">\(t\)</span></li>
<li><span class="math inline">\(\sigma_{kt}\)</span> is the corresponding standard deviation</li>
</ul>
<p>This transformation yields standardized feature vectors:</p>
<p><span class="math display">\[
\mathbf{z}_{it} = (z_{i1t}, \dots, z_{iKt})'
\]</span></p>
<p>Standardization ensures that all variables contribute equally in terms of variance to the similarity metric.</p>
</section>
<section id="distance-based-similarity" class="level2">
<h2 class="anchored" data-anchor-id="distance-based-similarity">5. Distance-Based Similarity</h2>
<p>Let <span class="math inline">\(NC\)</span> denote North Carolina. For each year <span class="math inline">\(t\)</span>, define the Euclidean distance between state <span class="math inline">\(i\)</span> and North Carolina as:</p>
<p><span class="math display">\[
d_{it} = \sqrt{\sum_{k=1}^{K} \left(z_{ikt} - z_{NC,kt}\right)^2}
\]</span></p>
<p>States are ranked in ascending order of <span class="math inline">\(d_{it}\)</span>. The <span class="math inline">\(n\)</span> states with the smallest distances form the comparison set for year <span class="math inline">\(t\)</span>.</p>
<p>This procedure is implemented separately for:</p>
<ol type="1">
<li>Economic indicators only</li>
<li>Education indicators only</li>
<li>Labor market indicators only</li>
<li>Demographic indicators only</li>
<li>The full set of indicators</li>
</ol>
<p>This modular approach allows identification of states that are similar along specific structural dimensions as well as overall similarity.</p>
<section id="implementation" class="level3">
<h3 class="anchored" data-anchor-id="implementation">5.1 Implementation</h3>
</section>
</section>
<section id="temporal-consistency" class="level2">
<h2 class="anchored" data-anchor-id="temporal-consistency">6. Temporal Consistency</h2>
<p>To assess structural stability of similarity, define:</p>
<p><span class="math display">\[
C_i = \sum_t \mathbb{1}(\text{rank}_{it} \le 5)
\]</span></p>
<p>where <span class="math inline">\(\mathbb{1}(\cdot)\)</span> is the indicator function and <span class="math inline">\(C_i\)</span> counts the number of years in which state <span class="math inline">\(i\)</span> appears among the five closest states to North Carolina.</p>
<p>Additionally define:</p>
<p><span class="math display">\[
\bar{d}_i = \frac{1}{T_i} \sum_t d_{it}
\qquad
\bar{r}_i = \frac{1}{T_i} \sum_t \text{rank}_{it}
\]</span></p>
<p>where <span class="math inline">\(T_i\)</span> is the number of years state <span class="math inline">\(i\)</span> appears in the comparison set.</p>
<p>States with high <span class="math inline">\(C_i\)</span>, low average distance <span class="math inline">\(\bar{d}_i\)</span>, and low average rank <span class="math inline">\(\bar{r}_i\)</span> are interpreted as structurally robust comparators.</p>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; ">
<caption>
Closest states to North Carolina in 2024 by indicator domain (lower distance implies greater similarity).
</caption>
<thead>
<tr>
<th style="text-align:right;">
year
</th>
<th style="text-align:left;">
rank
</th>
<th style="text-align:right;">
state
</th>
<th style="text-align:right;">
distance
</th>
</tr>
</thead>
<tbody>
<tr grouplength="10">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>All Indicators</strong>
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
Tennessee
</td>
<td style="text-align:right;">
1.347
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
Oregon
</td>
<td style="text-align:right;">
1.373
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
Missouri
</td>
<td style="text-align:right;">
1.487
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
Michigan
</td>
<td style="text-align:right;">
1.621
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
Arizona
</td>
<td style="text-align:right;">
1.901
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
Washington
</td>
<td style="text-align:right;">
1.954
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
Pennsylvania
</td>
<td style="text-align:right;">
1.960
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
8
</td>
<td style="text-align:right;">
Wisconsin
</td>
<td style="text-align:right;">
1.993
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
9
</td>
<td style="text-align:right;">
Illinois
</td>
<td style="text-align:right;">
2.218
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:right;">
Indiana
</td>
<td style="text-align:right;">
2.258
</td>
</tr>
<tr grouplength="10">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>Demographics</strong>
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
Illinois
</td>
<td style="text-align:right;">
0.648
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
Colorado
</td>
<td style="text-align:right;">
1.164
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
Pennsylvania
</td>
<td style="text-align:right;">
1.170
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
Arizona
</td>
<td style="text-align:right;">
1.338
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
Minnesota
</td>
<td style="text-align:right;">
1.369
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
Tennessee
</td>
<td style="text-align:right;">
1.527
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
New Jersey
</td>
<td style="text-align:right;">
1.530
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
8
</td>
<td style="text-align:right;">
Connecticut
</td>
<td style="text-align:right;">
1.530
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
9
</td>
<td style="text-align:right;">
Virginia
</td>
<td style="text-align:right;">
1.550
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:right;">
Wisconsin
</td>
<td style="text-align:right;">
1.594
</td>
</tr>
<tr grouplength="10">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>Economics</strong>
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
Florida
</td>
<td style="text-align:right;">
0.291
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
Tennessee
</td>
<td style="text-align:right;">
0.299
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
Arizona
</td>
<td style="text-align:right;">
0.587
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
Colorado
</td>
<td style="text-align:right;">
0.700
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
Rhode Island
</td>
<td style="text-align:right;">
0.720
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
Oregon
</td>
<td style="text-align:right;">
0.754
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
South Carolina
</td>
<td style="text-align:right;">
0.776
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
8
</td>
<td style="text-align:right;">
Minnesota
</td>
<td style="text-align:right;">
0.791
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
9
</td>
<td style="text-align:right;">
Washington
</td>
<td style="text-align:right;">
0.794
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:right;">
Michigan
</td>
<td style="text-align:right;">
0.801
</td>
</tr>
<tr grouplength="10">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>Education</strong>
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
Illinois
</td>
<td style="text-align:right;">
0.015
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
Hawaii
</td>
<td style="text-align:right;">
0.057
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
South Dakota
</td>
<td style="text-align:right;">
0.067
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
Maine
</td>
<td style="text-align:right;">
0.080
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
Nebraska
</td>
<td style="text-align:right;">
0.120
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
North Dakota
</td>
<td style="text-align:right;">
0.143
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
Oregon
</td>
<td style="text-align:right;">
0.166
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
8
</td>
<td style="text-align:right;">
Wisconsin
</td>
<td style="text-align:right;">
0.180
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
9
</td>
<td style="text-align:right;">
Rhode Island
</td>
<td style="text-align:right;">
0.181
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:right;">
New York
</td>
<td style="text-align:right;">
0.260
</td>
</tr>
<tr grouplength="10">
<td colspan="4" style="border-bottom: 1px solid;">
<strong>Labor Market</strong>
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:right;">
Tennessee
</td>
<td style="text-align:right;">
0.297
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
2
</td>
<td style="text-align:right;">
Idaho
</td>
<td style="text-align:right;">
0.346
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
3
</td>
<td style="text-align:right;">
Pennsylvania
</td>
<td style="text-align:right;">
0.389
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
4
</td>
<td style="text-align:right;">
Ohio
</td>
<td style="text-align:right;">
0.471
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
5
</td>
<td style="text-align:right;">
Michigan
</td>
<td style="text-align:right;">
0.487
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
6
</td>
<td style="text-align:right;">
Arizona
</td>
<td style="text-align:right;">
0.564
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
7
</td>
<td style="text-align:right;">
Virginia
</td>
<td style="text-align:right;">
0.640
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
8
</td>
<td style="text-align:right;">
Indiana
</td>
<td style="text-align:right;">
0.717
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
9
</td>
<td style="text-align:right;">
Oregon
</td>
<td style="text-align:right;">
0.734
</td>
</tr>
<tr>
<td style="text-align:right;padding-left: 2em;" indentlevel="1">
2024
</td>
<td style="text-align:left;">
10
</td>
<td style="text-align:right;">
Georgia
</td>
<td style="text-align:right;">
0.785
</td>
</tr>
</tbody>
</table>
<table class="table table-striped table-hover table-condensed table-responsive" style="width: auto !important; ">
<caption>
Temporal consistency of structural similarity (appearance in top-5; all indicators).
</caption>
<thead>
<tr>
<th style="text-align:left;">
state
</th>
<th style="text-align:right;">
years_in_top5
</th>
<th style="text-align:right;">
avg_rank
</th>
<th style="text-align:right;">
avg_distance
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Tennessee
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
1.78
</td>
<td style="text-align:right;">
1.388
</td>
</tr>
<tr>
<td style="text-align:left;">
Oregon
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
1.62
</td>
<td style="text-align:right;">
1.325
</td>
</tr>
<tr>
<td style="text-align:left;">
Missouri
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
3.50
</td>
<td style="text-align:right;">
1.498
</td>
</tr>
<tr>
<td style="text-align:left;">
Michigan
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3.20
</td>
<td style="text-align:right;">
1.402
</td>
</tr>
<tr>
<td style="text-align:left;">
Washington
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4.60
</td>
<td style="text-align:right;">
1.763
</td>
</tr>
<tr>
<td style="text-align:left;">
Indiana
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3.50
</td>
<td style="text-align:right;">
1.608
</td>
</tr>
<tr>
<td style="text-align:left;">
Pennsylvania
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3.50
</td>
<td style="text-align:right;">
1.620
</td>
</tr>
<tr>
<td style="text-align:left;">
Arizona
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
5.00
</td>
<td style="text-align:right;">
1.819
</td>
</tr>
<tr>
<td style="text-align:left;">
Wyoming
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:right;">
1.665
</td>
</tr>
<tr>
<td style="text-align:left;">
Wisconsin
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
5.00
</td>
<td style="text-align:right;">
1.845
</td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # Plot showing top states' distance from NC over time</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># all_vars_over_time |&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   filter(rank &lt;= 5) |&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   ggplot(aes(x = year, y = distance, color = state, group = state)) +</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_line(linewidth = 1) +</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   geom_point(size = 2) +</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   labs(</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co">#     title = "Distance from North Carolina Over Time",</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co">#     subtitle = "Based on all economic, education, labor, and demographic variables",</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#     x = "Year",</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#     y = "Standardized Distance",</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#     color = "State"</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   ) +</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   theme_minimal()</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="interpretation" class="level2">
<h2 class="anchored" data-anchor-id="interpretation">7. Interpretation</h2>
<p>The methodology identifies states that are observationally proximate to North Carolina in a multidimensional structural space. These states share similar income distributions, educational attainment profiles, labor force structures, and demographic compositions.</p>
<p>Importantly, similarity is evaluated annually. This permits structural alignment to evolve over time and avoids reliance on a single cross-sectional benchmark.</p>
<p>The resulting comparison set provides a principled empirical basis for subsequent analysis of labor market trajectories, policy differences, or growth dynamics.</p>
</section>
<section id="methodological-considerations" class="level2">
<h2 class="anchored" data-anchor-id="methodological-considerations">8. Methodological Considerations</h2>
<section id="equal-weighting" class="level3">
<h3 class="anchored" data-anchor-id="equal-weighting">8.1 Equal Weighting</h3>
<p>The Euclidean metric implicitly assigns equal weight to all standardized features:</p>
<p><span class="math display">\[
w_k = 1 \quad \forall k
\]</span></p>
<p>This assumption may not reflect substantive priorities. If labor market structure is of primary interest, weights could be introduced:</p>
<p><span class="math display">\[
d_{it}^{(w)} = \sqrt{\sum_{k=1}^{K} w_k \left(z_{ikt} - z_{NC,kt}\right)^2}
\]</span></p>
<p>where <span class="math inline">\(w_k\)</span> reflects theoretical importance.</p>
</section>
<section id="covariance-structure" class="level3">
<h3 class="anchored" data-anchor-id="covariance-structure">8.2 Covariance Structure</h3>
<p>Euclidean distance ignores correlation between features. Highly correlated variables may effectively double-count structural dimensions.</p>
<p>An alternative is the Mahalanobis distance:</p>
<p><span class="math display">\[
d_{it}^{(M)} =
\sqrt{(\mathbf{z}_{it} - \mathbf{z}_{NC,t})' \Sigma_t^{-1} (\mathbf{z}_{it} - \mathbf{z}_{NC,t})}
\]</span></p>
<p>where <span class="math inline">\(\Sigma_t\)</span> is the covariance matrix of standardized features in year <span class="math inline">\(t\)</span>. This accounts for cross-feature correlation.</p>
</section>
<section id="cross-sectional-standardization" class="level3">
<h3 class="anchored" data-anchor-id="cross-sectional-standardization">8.3 Cross-Sectional Standardization</h3>
<p>Standardizing within year removes national trends. While appropriate for identifying contemporaneous similarity, it suppresses information about relative divergence over time. An alternative would be pooled standardization across years or baseline-year anchoring.</p>
</section>
<section id="causal-interpretation" class="level3">
<h3 class="anchored" data-anchor-id="causal-interpretation">8.4 Causal Interpretation</h3>
<p>The method identifies structural comparators but does not guarantee comparability in policy regimes, institutional settings, or dynamic trajectories. It is therefore suitable as a selection mechanism for further analysis, not as a causal design in itself.</p>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">9. Conclusion</h2>
<p>This chapter develops a formal and replicable framework for identifying states structurally comparable to North Carolina. Using ACS data, multivariate standardization, and distance-based similarity metrics, the procedure defines comparison sets across economic, educational, labor market, and demographic dimensions.</p>
<p>The approach provides a transparent foundation for selecting comparator states in subsequent analyses of labor market development, while remaining flexible to alternative weighting schemes, covariance adjustments, or dynamic extensions in later stages of the research design.</p>
</section>
<section id="appendix-north-carolina-workforce-context" class="level2">
<h2 class="anchored" data-anchor-id="appendix-north-carolina-workforce-context">Appendix: North Carolina Workforce Context</h2>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/plt-nc-workforce-time-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>